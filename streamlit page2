import streamlit as st
from PIL import Image
import pytesseract

# ë©”ë‰´íŒì„ ë¶ˆëŸ¬ì˜¨ í›„ ì›í•˜ëŠ” ìŒì‹ ì„ íƒ
def main():
    # Streamlit ì•±ì˜ ë ˆì´ì•„ì›ƒ ë° ì„¤ì •ì„ ë³€ê²½
    st.set_page_config(page_title="YumScan", page_icon=":pizza:", layout="wide")

    st.title("Choose the food you want to get information")
    st.markdown("<p style='font-size: 25px;'>1.pizza</p>", unsafe_allow_html=True)
    st.markdown("<p style='font-size: 25px;'>2.pasta</p>", unsafe_allow_html=True)
    st.markdown("<p style='font-size: 25px;'>3.coke</p>", unsafe_allow_html=True)

# ìŒì‹ì— ë“¤ì–´ìˆëŠ” ì¬ë£Œì— ëŒ€í•œ ì‚¬ì§„ê³¼ ì„¤ëª… 
    st.markdown("<hr>", unsafe_allow_html=True)
    st.title("Ingredients")
    st.markdown("<p style='font-size: 20px;'>The ingredients in this food are as follows.</p>", unsafe_allow_html=True)
    st.write(" ")

    cols = st.columns(3)

    # ì²« ë²ˆì§¸ ì¬ë£Œ ì •ë³´ (ì´ë¯¸ì§€ì™€ ì„¤ëª…)
    with cols[0]:
        st.image("vegetable.png", use_column_width=True)
        st.write("ì²« ë²ˆì§¸ ì¬ë£Œ ì„¤ëª…")
    
    # ë‘ ë²ˆì§¸ ì¬ë£Œ ì •ë³´ (ì´ë¯¸ì§€ì™€ ì„¤ëª…)
    with cols[1]:
        st.image("vegetable.png", use_column_width=True)
        st.write("ë‘ ë²ˆì§¸ ì¬ë£Œ ì„¤ëª…")

    # ì„¸ ë²ˆì§¸ ì¬ë£Œ ì •ë³´ (ì´ë¯¸ì§€ì™€ ì„¤ëª…)
    with cols[2]:
        st.image("vegetable.png", use_column_width=True)
        st.write("ì„¸ ë²ˆì§¸ ì¬ë£Œ ì„¤ëª…")


# ìŒì‹ì´ ìœ ë°œí•  ìˆ˜ ìˆëŠ” ì•ŒëŸ¬ì§€ì— ëŒ€í•œ ì‚¬ì§„ê³¼ ì„¤ëª…

    st.title("Allergies")
    st.markdown("<p style='font-size: 20px;'>This food can cause the following allergies.</p>", unsafe_allow_html=True)
    st.write(" ")
    st.write(" ")

    # ì•ŒëŸ¬ì§€ì— ëŒ€í•œ ì‚¬ì§„ê³¼ ì„¤ëª…
    allergy_data = {
        "image": "vegetable.png",
        "description": "ì•ŒëŸ¬ì§€ì— ëŒ€í•œ ì„¤ëª…ì…ë‹ˆë‹¤."
    }

    cols = st.columns(2)

    with cols[0]:
        st.image(allergy_data["image"], width=200)

    with cols[1]:
        st.write(allergy_data["description"])

if __name__ == "__main__":
    main()

# Spicy-level (NULL ìˆ˜ì •ì™„ë£Œ)
st.title("ìŒì‹ì˜ ë§µê¸° ë‹¨ê³„")

# ê° ìŒì‹ì˜ ê¸°ë³¸ ë§µê¸° ë‹¨ê³„ ì„¤ì •
spiciness_levels = {
    "íŒŒìŠ¤íƒ€": 1,
    "í”¼ì": 2,
    "ì¹˜í‚¨": 3,
    "ì½œë¼": 0,
    "ì¹˜ì¦ˆ": None
}

# ìŒì‹ ëª©ë¡ ìƒì„±
foods = list(spiciness_levels.keys())

# ìŒì‹ ì„ íƒ
selected_food = st.selectbox("ìŒì‹ ì„ íƒ", foods)

# null ê°’ì„ ì„ íƒí•œ ê²½ìš°
if selected_food == "ì¹˜ì¦ˆ":
    is_null = st.write("UNKNOWN")
    if is_null:
        spicy_level = None
    else:
        # "ì¹˜ì¦ˆ"ì¸ ê²½ìš° ìŠ¬ë¼ì´ë”ë°”ë¥¼ ë¹„í™œì„±í™”í•˜ê³  ë¶ˆíˆ¬ëª…í•˜ê²Œ í‘œì‹œ
        with st.empty():
            spicy_level = None
else:
    spicy_level = st.slider("ë§µê¸° ë‹¨ê³„", min_value=0, max_value=3, value=spiciness_levels[selected_food], step=1, format="ğŸŒ¶ï¸ %d")

# ì„ íƒëœ ë§µê¸° ë‹¨ê³„ì™€ null ì—¬ë¶€ì— ë”°ë¼ ê²°ê³¼ ì¶œë ¥
if spicy_level is None:
    st.write(f"{selected_food}ì˜ ë§µê¸° ë‹¨ê³„: Null")
else:
    st.write(f"{selected_food}ì˜ ë§µê¸° ë‹¨ê³„:", spicy_level)


# í™˜ìœ¨ ì •ë³´ (ì‹¤ì‹œê°„ í™˜ìœ¨ ì •ë³´ë¥¼ ì‚¬ìš©)
import requests

def get_exchange_rates(api_key):
    url = f"https://api.currencyfreaks.com/latest?apikey=21a31a1e5b4346b3877828cea5953658"
    headers = {
        "apikey": api_key
    }
    response = requests.get(url, headers=headers)
    data = response.json()
    return data["rates"]

base_currency = "USD"  # ê¸°ì¤€ í™”í
target_currencies = ["USD", "JPY", "CNY", "TWD"]  # ëŒ€ìƒ í™”íë“¤
api_key = "21a31a1e5b4346b3877828cea5953658"  # currencyfreaksì—ì„œ ë°œê¸‰ë°›ì€ API í‚¤ë¥¼ ì…ë ¥

exchange_rates = get_exchange_rates(api_key)

# í™˜ìœ¨ ì •ë³´ë¥¼ í™•ì¸
print(exchange_rates)

krw_exchange_rate = exchange_rates.get("KRW")
jpy_exchange_rate = exchange_rates.get("JPY")
cny_exchange_rate = exchange_rates.get("CNY")
twd_exchange_rate = exchange_rates.get("TWD")

exchange = {
    "KRW": krw_exchange_rate,  
    "JPY": jpy_exchange_rate,   
    "CNY": cny_exchange_rate,   
    "TWD": twd_exchange_rate    
}

# ê°€ë¡œì„  ì¶”ê°€
st.markdown("<hr>", unsafe_allow_html=True)

st.title("Today's Exchange Rate")

BASE_currency = "KRW"
krw_exchange_rate = float(krw_exchange_rate)
jpy_exchange_rate = float(jpy_exchange_rate)
cny_exchange_rate = float(cny_exchange_rate)
twd_exchange_rate = float(twd_exchange_rate)

usd_exchange_rate = exchange_rates.get("USD")
usd_exchange_rate = float(usd_exchange_rate)
USD_currency = usd_exchange_rate/krw_exchange_rate

if USD_currency is not None:
    USD_currency = float(USD_currency)
      # ë¬¸ìì—´ì„ ì‹¤ìˆ˜í˜•ìœ¼ë¡œ ë³€í™˜
    st.write(f"1 {BASE_currency} = {USD_currency:.4f} USD")
else:
    st.write("USDì˜ í™˜ìœ¨ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.")

JPY_currency = jpy_exchange_rate/krw_exchange_rate

if JPY_currency is not None:
    JPY_currency = float(JPY_currency)
      # ë¬¸ìì—´ì„ ì‹¤ìˆ˜í˜•ìœ¼ë¡œ ë³€í™˜
    st.write(f"1 {BASE_currency} = {JPY_currency:.4f} JPY")
else:
    st.write("JPYì˜ í™˜ìœ¨ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.")

CNY_currency = cny_exchange_rate/krw_exchange_rate

if CNY_currency is not None:
    CNY_currency = float(CNY_currency)
      # ë¬¸ìì—´ì„ ì‹¤ìˆ˜í˜•ìœ¼ë¡œ ë³€í™˜
    st.write(f"1 {BASE_currency} = {CNY_currency:.4f} CNY")
else:
    st.write("CNYì˜ í™˜ìœ¨ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.")

TWD_currency = twd_exchange_rate/krw_exchange_rate

if TWD_currency is not None:
    TWD_currency = float(TWD_currency)
      # ë¬¸ìì—´ì„ ì‹¤ìˆ˜í˜•ìœ¼ë¡œ ë³€í™˜
    st.write(f"1 {BASE_currency} = {TWD_currency:.4f} TWD")
else:
    st.write("TWDì˜ í™˜ìœ¨ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.")

# ê°€ë¡œì„  ì¶”ê°€
st.markdown("<hr>", unsafe_allow_html=True)

st.title("Price info - ì‹¤ì‹œê°„ í™˜ìœ¨ ì •ë³´ ì‚¬ìš© (KRW ê¸°ì¤€)")

EXCHANGE = {
    "USD": USD_currency,  
    "JPY": JPY_currency,   
    "CNY": CNY_currency,   
    "TWD": TWD_currency   
}

BASE_currency = "KRW"
target_currencies = ["USD", "JPY", "CNY", "TWD"]

st.write("BASE_currency:", BASE_currency)
BASE = st.number_input("enter price", key="BASE", min_value=0.01)

st.write("choose target_currencies:")
TARGET = st.selectbox("select currency", target_currencies, key="TARGET")

converted_amount = BASE * EXCHANGE[TARGET]
st.write(f"{BASE:.2f} {BASE_currency} = {converted_amount:.2f} {TARGET}")
